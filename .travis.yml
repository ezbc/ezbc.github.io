sudo: false
language: ruby
cache: bundler
rvm:
- 2.7.0
branches:
  only:
    - master
    - develop
before_install:
  - export TRAVIS_BUILD_ENV="dev"
  - if [[ "$TRAVIS_BRANCH" = "master" ]]; then export TRAVIS_BUILD_ENV="prod"; fi
install:
- echo "$TRAVIS_BUILD_ENV"
- bundle install
- gem install jekyll
script:
- bundle exec jekyll build --config _config.yml,_config_"$TRAVIS_BUILD_ENV".yml
deploy:
  - provider: firebase
    skip_cleanup: true
    token:
      secure: "M6zgrIA9ybGlpbP5O0CWvP+AjjZ1nDHCao55CuSflvAsmj52agwdJ/OrrZjSaY78gpm3XAjsE7xvgTm0W/KkSZ9WVMHn+WziZi8b+tJ+tGRvr28WWmQW1BILjsupOI7dfSbQUdK0oZfUfwDLcUzpAQjR0NDYlpsS5v3gEwyGhpYsrz2/htpaxnFBeXblweaZTu5A1+wrIHtGzuFA84fUnp9RXnYM8m1nqSYwF1R0Tv6G6/oLmdNg9sTWYLpP50tAQu6KhHMJUgH1RUgaWhchv9p/nwYS9xR/AYHTlQCsFuLGDdElMjg+BnpT3tXH6mA25AlcilVFdmtxlNYLV9nlGN9YhrBnQaRk22fWdax0oNcPwWACvd+miCxPrvwPfZYq0oYx9stnai8fCCvG0CjJY4ql9gT5JzUwTs/UjBInRig3k0qKCX3OdYS6sCMLiw7MQ984KQ9JhdZUpwj+9g+jRtQOP+YeFwRLe12IpBZRNhnnpcMQONpxkwgUvIurKQJynxquSgYhJuNk8sp3hlzR9jEKAewK2gzloPxUlladUmhkoR+CTUme603H/bWoU7C+mtPakHw2sYQkRGfqFJAyer7O1vjIzkMtXwYyD1pJteELmKpMBooKnKBXyJeEzHBAhV8qpC/7ijwZyENmgVfOt1sMk1IWe1XqGX29enTEVcY="
    project: "devezbcme"
    on:
      branch: "develop"
    message: "Deploying to $TRAVIS_BUILD_ENV environment"
  - provider: firebase
    skip_cleanup: true
    token:
      secure: "WTQd1OPFVe40nJ3HzvTRAkk4GHJUhr87OgEywrZleXg356V+MJvUxY0GR3q9bNLvvH/Uk5jxQwhBs8Q3LVUQSijuMTxqgmxFNM8l9J99/SBIDwKOQzbMz6yPiNOpU5/wmSB4vMZOxcLlY/ilShFzcYgYwpoZrjRjsw/IVNcbXLh/QVI2YcBO2jcfKhxS3rO4l9MLBwK56eqWvatUCa5f3DcQj/wDa9CJu5/AwrQf+6z0JfuDi8v/afQhOh91oviq9bknJoRvHP80Qmwt2AplrdqGusMm+19OSlW64bdxi/70vaeQSP18cKYiIjxDrzIFznw0ZZMR233ZshBqSQNF/cWpOsWQZP4fw0V7Xw+/XIhu2sWPe6Oy4Rxc3FGLK+tzzTaILfChcEQIWjXV6qYrzK+FJnZ6qJUJLtJeDTkq3i1QY7aRWWlwPi0P9FLrJSx74847HOLiKujeGoPtGJLFuuLqMJUHFDZSxH+X/hogD4BZcYAltvr/eFQX+2qOGTuv1q02V/lBM/JWPW37ggWdOuF84nCinavdrU1IQJ0i8s96E4ZHqD64Y5BBu8cYE8iwD0T0EfbMNt610u1ZdDOE4NCGZ04mfyYmH0U+yrKEFGuTOjd+PuyzRpKG1Jlz1pNH8gn66qS6QqmRFgciWktWw/JmdE3v4QOa96JADJAnkLo="
    project: "prodezbcme"
    on:
      branch: "master"
    message: "Deploying to $TRAVIS_BUILD_ENV environment"
notifications:
  email:
    on_success: always
    on_failure: always
after_success:
  - bash scripts/clearcache.sh -k "$CF_AUTH_KEY" -e "$CF_AUTH_EMAIL" -z "$CF_ZONE"

