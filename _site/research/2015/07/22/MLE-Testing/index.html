<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Elijah's Webpage  &mdash; Reevaluating the MLE, and Negative Intercepts </title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="alternate" type="application/atom+xml" title="Elijah's Webpage" href="/feed.xml">
        <!-- Loop and attach page tags from page meta section -->
        
        <meta name="keywords" content="Taurus-California-PerseusResidualsMasking">
        
        <link rel="icon" type="image/png"
            href="/favicon.png">


        <!-- Clicks
        <script
            src="/assets/js/click.js">
        </script>
        -->

        <!-- Custom CSS -->
        <link rel="stylesheet"
            href="/assets/css/main.css">
        <link rel="stylesheet" media="print"
            href="/assets/css/print.css"/>
        <link
            href='http://fonts.googleapis.com/css?family=Poly:400,400italic'
            rel='stylesheet' type='text/css'>

        <!-- JQuery -->
        <script
            src="/assets/js/jquery-1.10.2.js">
        </script>

        <!-- Loading Bar -->
        <script
            src="/assets/js/pace.min.js">
        </script>

        <!-- Owl-carousel -->
        <link rel="stylesheet" href="/plugins/owlcarousel/owl.carousel.min.css">
        <link rel="stylesheet"
            href="/plugins/owlcarousel/owl.theme.default.min.css">

        <!-- Slick Carousel -->
        <link rel="stylesheet" type="text/css"
            href="/plugins_html/slick-1.5.7/slick/slick-theme.css"/>
        <link rel="stylesheet" type="text/css"
            href="/plugins_html/slick-1.5.7/slick/slick.css">
        <script type="text/javascript"
            src="//code.jquery.com/jquery-1.11.0.min.js">
        </script>
        <script type="text/javascript"
            src="//code.jquery.com/jquery-migrate-1.2.1.min.js">
        </script>
        <script type="text/javascript"
            src="/plugins_html/slick-1.5.7/slick/slick.min.js">
        </script>

        <!-- Bootstrap -->
        <link href="css/bootstrap.min.css" rel="stylesheet">

        <!-- Table of Contents -->
        <script
            src="/assets/js/jquery.toc.js">
        </script>

        <!-- Image Zoom -->
        <script
            src="/plugins_html/elevatezoom-master/jquery.elevatezoom.js" 
            type="text/javascript">
        </script>
        
        <!-- JS functions -->
        <script
            type="text/javascript"
            src="/assets/js/application.js">
        </script>

        <!-- Slick Carousel -->
        <script
            type="text/javascript"
            src="/assets/js/image_carousel.js">
        </script>

        <!-- Mathjax -->
        <script 
            type="text/javascript" 
            src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>
        <!-- allow single dollar sign escape for mathjax -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
            tex2jax: {
              inlineMath: [ ['$','$'], ],
              processEscapes: true,
              processEnvironments: true,
            },
            TeX: {
              Macros: {
                nhi : "N(HI)",
                htwo : "H_2",
                in : "^{\\prime\\prime}",
                ft : "^{\\prime}",
                deg : "^\\circ",
              }
            }
          });
        </script>

        <script 
            src="/assets/js/jquery.toc.js">
        </script>


        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-67026116-1', 'auto');
          ga('send', 'pageview');
        

        </script>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>



<!--
<style>
body { 
  background-padding: 0 !important;
  background-image: url('/images/background.jpg');
  background-repeat: no-repeat;
  background-attachment: fixed;
  background-position: left;
  background-min-width: 100px;
}
</style>
-->

<main>

<body>
    <!-- <span class="statusbar"></span> -->
    <!-- Wrap all page content here -->
    <div id="wrap">
        <div id="body" class="container">
            <div class="row row-offcanvas row-offcanvas-left">
                <!-- side navigation -->
                <nav id="nav" role="navigation" class="col-sm-2 sidebar-offcanvas">
                    <header id="menu" role="banner">
                        <p class="menu-title">Close</p>
                        <a href="#nav" class="close-btn">
                            <img src="/assets/fonts/close-btn.svg" alt="close button">
                        </a>
                    </header>
                    <ul class="sidebar" >

<!-- sort in alphebetical order -->
    <p class="separator">Navigation</p>
    <li><a href="/">Home</a></li>
    <li><a href="/research_log">Research Log</a></li>
    <li><a href="/hobbies">Hobbies</a></li>
    <li><a href="/contact">Contact</a></li>
    <li><a href="/search">Search</a></li>
    <li><a href="/tags">Tags</a></li>
    
    <a class="goto-top-link hide-on-phone" href="#top">
        <div class="goto-top text-center">
            <i class="fa fa-step-forward fa-rotate-270"></i>
        </div>
    </a>

</ul>
                    
                </nav>

                

                <header id="menu" role="banner">
                    <p class="menu-title">Menu</p>
                    <a href="#nav" class="menu-btn">
                        <img src="/assets/fonts/menu-btn.svg" alt="menu button">
                    </a>
                </header>
                <!-- Content -->
                <div class="col-sm-10">
                    <nav class="top">
                        <a href="/index.html">Blogs, astro, and more &mdash; Elijah's Webpage</a>
                        <span class="pull-right">
                            <a id="twitter-ic" class="link" href="https://twitter.com/ebernste1">
                                <i class="fa fa-twitter fa-lg"></i>
                            </a>
                            <a id="git-ic" class="link" href="https://github.com/ezbc">
                                <i class="fa fa-github-square fa-lg"></i>
                            </a>
                            <a id="git-ic" class="link" href="https://bitbucket.org/ezbc">
                                <i class="fa fa-bitbucket-square fa-lg"></i>
                            </a>
                            <a id="git-ic" class="link"
                                href="https://plus.google.com/+ElijahBernsteinCooper">
                                <i class="fa fa-google-plus fa-lg"></i>
                            </a>
                            <a id="git-ic" class="link"
                                href="https://linkedin.com/in/ElijahBernsteinCooper">
                                <i class="fa fa-linkedin fa-lg"></i>
                            </a>
                            </a>
                            <a id="rss-ic" class="link" href="/feed.xml">
                                <i class="fa fa-rss fa-lg"></i>
                            </a>
                        </span>
                    </nav>
                    <div class="row">
                        <body>
    <div class="col-sm-12">
        <div class="page">
            <div class="page-title">
                Reevaluating the MLE, and Negative Intercepts
                <div class="meta">    			
                    
                    By Elijah Bernstein-Cooper,
                    
                    July 22, 2015,
                    <a href="/research/2015/07/22/MLE-Testing/#disqus_thread">0 <i class="fa fa-comments-o fa-lg"></i></a>
                    comments.
                </div>
            </div>
            <div class="page-content">
                <p><strong>Table of Contents</strong></p>

<hr style="height:2px; background-color:#b6b6b6" />

<ul id="markdown-toc">
  <li><a href="#likelihoods">Likelihoods</a></li>
  <li><a href="#evaluating-mle-fits">Evaluating MLE Fits</a></li>
  <li><a href="#understanding-the-intercept">Understanding the Intercept</a></li>
</ul>

<hr style="height:2px; background-color:#b6b6b6" />

<h2 id="likelihoods">Likelihoods</h2>

<p>The likelihood calculations discussed in the <a href="/research/2015/07/21/Masking/">previous
post</a> are incorrect. There was a bug related to masking
NaNs in the HI cube. All figures below were calculated using these versions of
<a href="https://bitbucket.org/ezbc/scripts_and_logs/src/f7ec232922b90feee58d941b3959d32d1d7e6683/multicloud/analysis/clouds/cloud_analysis.py?at=master"><code>cloud_analysis.py</code></a>
and
<a href="https://bitbucket.org/ezbc/python_modules/src/4122edf55decca4a91abac1cce6a27e45e005268/cloudpy.py?at=master"><code>cloudpy.py</code></a>.</p>

<p>The likelihoods do indeed require a rescaling of the error after the first MLE
calculation, and recalculating the MLE with the rescaled errors. Below are the
results.</p>

<hr />

<div align="center"> Perseus, Lee+12 </div>

<p><img src="/images/2015-07-22/perseus_lee12_binned_coarseres_likelihood_wd.png" style="float: left; width: 48%; margin-right: 1%; margin-bottom: 0.5em;" /></p>

<p><img src="/images/2015-07-22/perseus_lee12_binned_coarseres_likelihood_wi.png" style="float: left; width: 48%; margin-right: 1%; margin-bottom: 0.5em;" /></p>

<p>Figure 1. - Perseus likelihoods with Lee+12 <script type="math/tex">A_V</script> data. These likelihoods are
not similar to those found in <a href="/research/2015/07/07/Lee12-Test/#nobackground">previous
iterations</a> of the MLE analysis. The
width is much larger, and the intercept is near 0. The <script type="math/tex">HI</script> column densities
will be much more similar to Lee et al. (2012) for a width of 40 km/s than
found earlier, about 13 km/s. The bulk of the <script type="math/tex">HI</script> emission is included
within a width of 20 km/s, thus increasing the width to 40 km/s will not change
<script type="math/tex">N(HI)</script> much. The <script type="math/tex">N(HI)</script> distributions are discussed later in the post</p>

<hr />

<hr />

<div align="center"> Perseus, Planck </div>

<p><img src="/images/2015-07-22/perseus_planck_binned_coarseres_likelihood_wd.png" style="float: left; width: 48%; margin-right: 1%; margin-bottom: 0.5em;" /></p>

<p><img src="/images/2015-07-22/perseus_planck_binned_coarseres_likelihood_wi.png" style="float: left; width: 49%; margin-right: 1%; margin-bottom: 0.5em;" /></p>

<p>Figure 2. - Perseus likelihoods with Planck <script type="math/tex">A_V</script> data. These likelihoods are
very similar to those found with the Lee+12 <script type="math/tex">A_V</script> data above. This is
promising!</p>

<hr />

<hr />

<div align="center"> Taurus </div>

<p><img src="/images/2015-07-22/taurus_planck_binned_coarseres_likelihood_wd.png" style="float: left; width: 48%; margin-right: 1%; margin-bottom: 0.5em;" /></p>

<p><img src="/images/2015-07-22/taurus_planck_binned_coarseres_likelihood_wi.png" style="float: left; width: 48%; margin-right: 1%; margin-bottom: 0.5em;" /></p>

<p>Figure 3. - Taurus likelihoods. These likelihoods are not similar to those
found in previous iterations of the MLE analysis, which found <script type="math/tex">HI</script> widths of
about 10 km/s. This is likely because there were many NaNs in the <script type="math/tex">HI</script> cube
which distorted the likelihood calculation.</p>

<hr />

<hr />

<div align="center"> California </div>

<p><img src="/images/2015-07-22/california_planck_binned_coarseres_likelihood_wd.png" style="float: left; width: 48%; margin-right: 1%; margin-bottom: 0.5em;" /></p>

<p><img src="/images/2015-07-22/california_planck_binned_coarseres_likelihood_wi.png" style="float: left; width: 49%; margin-right: 1%; margin-bottom: 0.5em;" /></p>

<p>Figure 4. - California likelihoods. These likelihoods are similar to those
found in <a href="/research/2015/05/30/Intercepts/">previous iterations</a> of the MLE analysis.
This means that using either the faint-end or bright-end residual masking
selects the same diffuse pixels for the MLE analysis.</p>

<hr />

<h2 id="evaluating-mle-fits">Evaluating MLE Fits</h2>

<p>We can plot <script type="math/tex">A_V</script> vs. <script type="math/tex">N(HI)</script> to examine the distribution of points and the
fitted relationship. I have included the MLE fit as well as a polynomial fit to
the data. We can see for cloud the masking process has successfully masked
outliers which do not follow a linear correlation between <script type="math/tex">A_V</script> and
<script type="math/tex">N(HI)</script>. That is, for the masked data, <script type="math/tex">A_V</script> is linearly dependent on
<script type="math/tex">N(HI)</script>. See <a href="/research/2015/07/21/Masking/">yesterdayâ€™s post</a> for the first failed
attempt at examining this relationship (the MLE relationship I was plotting
incorrectly loaded the MLE parameters, hence were wrong).</p>

<p>If we compare the masked, binned data to the entire unbinned dataset we confirm
once again that the masking is working correctly. If all pixels were included,
or some <script type="math/tex">A_V</script> cutoff, the relationship would be skewed to a lower DGR and
higher intercept, e.g. if in Figure 5, we masked pixels where <script type="math/tex">A_V > 1</script> mag,
then more pixels would populate the lower <script type="math/tex">N(HI)</script>.</p>

<hr />

<div align="center"> Perseus, Lee+12 </div>

<p><img src="/images/2015-07-22/perseus_lee12_binned_coarseres_av_vs_nhi_masked.png" style="width:70%;" /></p>

<p><img src="/images/2015-07-22/perseus_lee12_binned_coarseres_av_vs_nhi.png" style="width:70%" /></p>

<p>Figure 5. - Perseus <script type="math/tex">A_V</script> vs. <script type="math/tex">N(HI)</script> using Lee+12 data. The top shows the
data points which the MLE of the parameters were fitted to, i.e., the masked
data and corresponding fit. The bottom shows all the unbinned data. The
contours are increasing logarithmically, with about 10,000 points included.
Each plot shows the model line determined by the MLE method, as well as a
polynomial fit to the data.</p>

<hr />

<hr />

<div align="center"> Perseus, Planck </div>

<p><img src="/images/2015-07-22/perseus_planck_binned_coarseres_av_vs_nhi_masked.png" style="width:70%;" /></p>

<p><img src="/images/2015-07-22/perseus_planck_binned_coarseres_av_vs_nhi.png" style="width:70%" /></p>

<p>Figure 6. - Perseus <script type="math/tex">A_V</script> vs. <script type="math/tex">N(HI)</script> using Planck data.</p>

<hr />

<hr />

<div align="center"> Taurus </div>

<p><img src="/images/2015-07-22/taurus_planck_binned_coarseres_av_vs_nhi_masked.png" style="width:70%" /></p>

<p><img src="/images/2015-07-22/taurus_planck_binned_coarseres_av_vs_nhi.png" style="width:70%" /></p>

<p>Figure 7. - Taurus <script type="math/tex">A_V</script> vs. <script type="math/tex">N(HI)</script>.</p>

<hr />

<hr />

<div align="center"> California </div>

<p><img src="/images/2015-07-22/california_planck_binned_coarseres_av_vs_nhi_masked.png" style="width:70%" /></p>

<p><img src="/images/2015-07-22/california_planck_binned_coarseres_av_vs_nhi.png" style="width:70%" /></p>

<p>Figure 8. - California <script type="math/tex">A_V</script> vs. <script type="math/tex">N(HI)</script>. </p>

<hr />

<h2 id="understanding-the-intercept">Understanding the Intercept</h2>

<p>A negative intercept means that there is excess <script type="math/tex">N(HI)</script> emission, or rather
background <script type="math/tex">HI</script>. In California, there is even a <script type="math/tex">A_V</script> background (see
<a href="/research/2015/06/24/Intercepts/">here</a>) of about <script type="math/tex">0.9</script> mag. A negative intercept of
<script type="math/tex">-0.8</script> means that there is about <script type="math/tex">1.7</script> mag of <script type="math/tex">A_V</script> associated with an
<script type="math/tex">HI</script> background. Given the DGR in California is <script type="math/tex">0.12 \times 10^{-20}</script>
cm<script type="math/tex">^{-2}</script> mag, the background <script type="math/tex">N(HI)</script> is about <script type="math/tex">14 \times 10^{20}</script>
cm<script type="math/tex">^{-2}</script>.</p>

<p><script type="math/tex">N(H_2)</script> vs. <script type="math/tex">N(HI)</script> distributions of each cloud. Even with the negative
intercept in California, most of the <script type="math/tex">N(H_2)</script> is above 0. This should relieve
the problem discussed in <a href="/research/2015/02/26/Krumholz-Fitting/">post on negative <script type="math/tex">H_2</script> surface
densities</a>.</p>

<hr />

<div align="center">
  
  <p>Perseus</p>

  <img src="/images/2015-07-22/perseus_planck_binned_coarseres_nh2_vs_nhi.png" style="width:70%" />

  <p>Taurus</p>

  <img src="/images/2015-07-22/taurus_planck_binned_coarseres_nh2_vs_nhi.png" style="width:70%" />

  <p>California</p>

  <img src="/images/2015-07-22/california_planck_binned_coarseres_nh2_vs_nhi.png" style="width:70%" />

</div>

<p>Figure 9. - Perseus, Taurus, and California <script type="math/tex">N(H_2)</script> vs. <script type="math/tex">N(HI)</script>
distributions derived from Planck data. It is apparent that California and
Taurus have a much wider distribution of <script type="math/tex">N(HI)</script> thresholds corresponding to
large hikes in <script type="math/tex">N(H2)</script>.</p>

<hr />


                <!-- Share & Comments -->
                <div class="share">
    <p>Posted:
        <i>
            Wednesday 22 July 2015
        </i>
        <a class="pull-right" href="https://twitter.com/intent/tweet?url=/research/2015/07/22/MLE-Testing/&text=Reevaluating the MLE, and Negative Intercepts&via=ebernste1" target="_blank">
            <i class="fa fa-retweet" style="color:red;"></i> Share
        </a>
    </p>
    
       <ul>
           <li>Related:</li>
           <ul>
           
              
                  <li>
                      <a href="/research/2015/11/04/varying-phi-g-in-mc/">Varying Dust Opacity and Gas Temperatures</a>
                  </li>
              
                  <li>
                      <a href="/research/2015/11/01/gas-temperatures/">Gas Temperatures</a>
                  </li>
              
                  <li>
                      <a href="/research/2015/10/22/model-fits/">Addressing Core Variation</a>
                  </li>
              
           </ul>
       </ul>
    
</div>

<div class="comments">
    <div id="disqus_thread"></div>
</div>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

            
            </div>
        </div>
    </div>
</body>
        
<!-- Disques -->
<script>
    $(".page-preview-icon").hover(function(){
        $(this).parents(".page-nav").css("z-index","5000");
    });
    
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'httpezbcme'; // required: replace example with your forum shortname

/** Err
var disqus_identifier = '2015-07-22-MLE-Testing.md';
var disqus_url = '/research/2015/07/22/MLE-Testing/';
**/
   
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();



/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'httpezbcme'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());

</script>


                    </div>
                </div>
            </div>
        </div>
        <footer class="footer text-center meta">
            Powered by <a class="link" href="https://github.com/nadjetey/wangana">Wangana</a> &mdash; Jekyll theme.
        </footer>
    </div>
</body>
</main>
        <!-- Other JavaScripts -->
        <script src="/assets/js/bootstrap.min.js"></script>        
        <script src="/assets/js/jquery.timeago.js"></script>
        <script>
          (function(i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

ga('create', 'ezbc', 'ezbc');
ga('send', 'pageview');
          $(document).ready(function() {
    var timer;

    $(window).bind('scroll', (function() {
        clearTimeout(timer);
        timer = setTimeout(getPercent, 5);
        isTop();
    }));

    $(".goto-top-link").click(function(){
        event.preventDefault();
        $('html, body').animate({ scrollTop: 0 }, 'slow');
    });
});

function scrollPossition() {
    return ($(window).scrollTop() / ($(document).height() - $(window).height())) * 100;
}

function getPercent() {
    $(".statusbar").css("width", String(scrollPossition()) + "%");

    if (scrollPossition() > 97) {
        $(".statusbar").css("background-color", "#1ca265");
    } else {
        $(".statusbar").css("background-color", "#eb5e29");
    }
    return;
}

function isTop() {
  if(scrollPossition() > 30)
    $(".goto-top").fadeIn("slow");
  else
    $(".goto-top").fadeOut("slow");
}
          $(document).ready(function() {
    $('.menu-btn').click(function() {
        $('.row-offcanvas').toggleClass('active');
    });
    $('.close-btn').click(function() {
        $('.row-offcanvas').toggleClass('active');
    });
});
          jQuery(document).ready(function() {
    jQuery("time.timeago").timeago();
});
        </script>


        <!-- Owl-carousel -->
        <script src="jquery.min.js"></script>
        <script src="owlcarousel/owl.carousel.min.js"></script>

    </body>
</html>



